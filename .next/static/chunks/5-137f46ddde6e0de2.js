"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5],{49005:function(e,t,a){a.r(t),a.d(t,{default:function(){return ProjectDetailAdmin}});var n=a(85893),s=a(67294),l=a(84053),i=a(11163),o=a(54887),c=a(98481),d=a(92720),r=a(29505),g=a(90606),u=a(15704),x=a(15379),h=a(55678);a(27967);var p=a(44650),m=a(21056),f=a(20839),v=a(76308);let{convert:j}=a(11024),{v4:b}=a(67429);function ProjectDetailAdmin(){let e=(0,l.useSession)(),t=(0,i.useRouter)(),a=(0,s.useRef)(null),j=new Date,[N,_]=(0,s.useState)([]),[y,S]=(0,s.useState)([]),[q,C]=(0,s.useState)([]),[T,w]=(0,s.useState)(""),[E,I]=(0,s.useState)(""),[k,D]=(0,s.useState)(""),[P,R]=(0,s.useState)(""),[A,O]=(0,s.useState)("/no-image.png"),[H,M]=(0,s.useState)(""),[V,Y]=(0,s.useState)(""),[z,Z]=(0,s.useState)(""),[B,F]=(0,s.useState)(""),[G,J]=(0,s.useState)(""),[U,K]=(0,s.useState)(""),[L,Q]=(0,s.useState)(""),[W,X]=(0,s.useState)("");async function insertDataTinRao(e){let{data:a,error:n}=await p.O.from("projects").insert(e);n?console.log("Error:",n.message):((0,x.x9)("Đăng tin th\xe0nh c\xf4ng"),t.push("/cms/tin-da-dang",void 0,{shallow:!0}))}async function updatetDataTinRao(e){console.log(e.id);let{data:t,error:a}=await p.O.from("projects").update(e).eq("id",String(e.id));a?console.log("Error:",a.message):(console.log(t),(0,x.x9)("Sửa tin th\xe0nh c\xf4ng"))}async function uploadImage(e){console.log(e);let t=e.target.files;for(let a=0;a<t.length;a++){let t=!0;if(e.target.files[a].size>512e4&&((0,x._N)("H\xecnh ".concat(e.target.files[a].name," kh\xf4ng được qu\xe1 5 MB")),t=!1),["jpeg","png","jpg","gif"].includes(e.target.files[a].type.split("/").pop())||((0,x._N)("H\xecnh ".concat(e.target.files[a].name," kh\xf4ng đ\xfang định dạng, định dạng đ\xfang 'jpeg','png','jpg','gif' ")),t=!1),t){let t=e.target.files[a];console.log(t);let{data:n,error:s}=await p.O.storage.from("project_image/avatar").upload(b(),t);n?(console.log(n),O("https://vyjeeoqetducftdoemqr.supabase.co/storage/v1/object/public/project_image/avatar/".concat(n.path))):console.log(s)}}}return(0,s.useEffect)(()=>{if(t.query.postId){let e={id:t.query.postId},a="/api/projects/projectDetail?".concat(o.Z.stringify(e));fetch(a).then(e=>e.json()).then(e=>{C(e),I(e.name_vn),D(e.diachi_vn),R(e.info_vn),O(e.img),M(e.tongquan_vn),Y(e.vitri_vn),Z(e.tienich_vn),F(e.matbang_vn),J(e.tiendo_vn),K(e.pttt_vn),Q(e.active),X(e.deleted)})}},[t.query.postId]),(0,n.jsxs)(n.Fragment,{children:[e?(0,n.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),console.log(e.target.name),""==E||""==k)return(0,x._N)("Vui l\xf2ng điền t\xean dự \xe1n..."),!1;let a={id:null==t.query.postId?b():t.query.postId,name_vn:E,diachi_vn:k,info_vn:P,img:A,tongquan_vn:H,vitri_vn:V,tienich_vn:z,matbang_vn:B,tiendo_vn:G,pttt_vn:U,date_added:j,date_modified:j,active:L||"1",deleted:W||"0"};"0"!=t.query.postId?(console.log(a),delete a.date_added,updatetDataTinRao(a)):(console.log(a),delete a.date_modified,insertDataTinRao(a),t.push("/cms/tin-da-dang",void 0,{shallow:!0}))},encType:"multipart/form-data",children:[(0,n.jsx)(f.default,{}),(0,n.jsx)("div",{className:"grid grid-cols-12 gap-5",children:(0,n.jsx)("div",{className:"col-span-12",children:(0,n.jsx)("div",{className:"flex w-full flex-col",children:(0,n.jsxs)(d.n,{"aria-label":"Options",children:[(0,n.jsx)(r.r,{title:"Th\xf4ng tin chung",children:(0,n.jsxs)("div",{className:"grid grid-cols-12 gap-5",children:[(0,n.jsx)("div",{className:"col-span-12",children:(0,n.jsx)(g.Y,{value:E,onChange:e=>I(e.target.value),type:"text",variant:"flat",label:"Name",name:"name",placeholder:"t\xean dự \xe1n...",labelPlacement:"outside"})}),(0,n.jsx)("div",{className:"col-span-12",children:(0,n.jsx)(g.Y,{value:k,onChange:e=>D(e.target.value),type:"text",variant:"flat",name:"address",label:"Address",placeholder:"địa chỉ dự \xe1n...",labelPlacement:"outside"})}),(0,n.jsx)("div",{className:"col-span-12",children:(0,n.jsx)(g.Y,{value:P,onChange:e=>R(e.target.value),type:"text",variant:"flat",name:"info",label:"Giới thiệu ngắn",placeholder:"giới thiệu...",labelPlacement:"outside"})}),(0,n.jsxs)("div",{className:"col-span-12",children:[(0,n.jsx)("p",{className:"font-bold text-sm",children:"H\xecnh đại diện"}),(0,n.jsxs)("div",{className:"flex flex-wrap relative",children:[(0,n.jsx)(u.J,{width:240,src:A,alt:"NextUI Album Cover",onClick:()=>{a.current&&a.current.click()},className:"w-40 h-40 m-5 text-large cursor-pointer"}),"/no-image.png"!=A?(0,n.jsx)("p",{className:"absolute bottom-6 left-6 z-10 cursor-pointer",onClick:()=>O("/no-image.png"),children:(0,n.jsx)(c.Z,{className:"text-2xl text-green-400 pointer-events-none"})}):""]}),(0,n.jsx)("input",{type:"file",name:"myImage",ref:a,onChange:e=>uploadImage(e),style:{display:"none"}})]})]})},"thong-tin-chung"),(0,n.jsx)(r.r,{title:"Tổng quan",children:(0,n.jsx)("div",{className:"grid grid-cols-12 gap-5",children:(0,n.jsxs)("div",{className:"col-span-12",children:[(0,n.jsx)("p",{className:"font-bold text-base py-5",children:"Tổng quan"}),(0,n.jsx)(v.default,{value:H,onEditorChange:e=>M(e)})]})})},"tong-quan"),(0,n.jsx)(r.r,{title:"Vị tr\xed",children:(0,n.jsxs)("div",{className:"col-span-12",children:[(0,n.jsx)("p",{className:"font-bold text-base py-5",children:"Vị tr\xed"}),(0,n.jsx)(v.default,{value:V,onEditorChange:e=>Y(e)})]})},"vi-tri"),(0,n.jsx)(r.r,{title:"Tiện \xedch",children:(0,n.jsxs)("div",{className:"col-span-12",children:[(0,n.jsx)("p",{className:"font-bold text-base py-5",children:"Tiện \xedch"}),(0,n.jsx)(v.default,{value:z,onEditorChange:e=>Z(e)})]})},"tien-ich"),(0,n.jsx)(r.r,{title:"Mặt bằng",children:(0,n.jsxs)("div",{className:"col-span-12",children:[(0,n.jsx)("p",{className:"font-bold text-base py-5",children:"Mặt bằng"}),(0,n.jsx)(v.default,{value:B,onEditorChange:e=>F(e)})]})},"mat-bang"),(0,n.jsx)(r.r,{title:"Tiến độ",children:(0,n.jsxs)("div",{className:"col-span-12",children:[(0,n.jsx)("p",{className:"font-bold text-base py-5",children:"Tiến độ"}),(0,n.jsx)(v.default,{value:G,onEditorChange:e=>J(e)})]})},"tien-do"),(0,n.jsx)(r.r,{title:"PTTT",children:(0,n.jsxs)("div",{className:"col-span-12",children:[(0,n.jsx)("p",{className:"font-bold text-base py-5",children:"Phương thức thanh to\xe1n"}),(0,n.jsx)(v.default,{value:U,onEditorChange:e=>K(e)})]})},"pttt")]})})})})]}):(0,n.jsx)(m.default,{}),(0,n.jsx)(h.Ix,{})]})}}}]);